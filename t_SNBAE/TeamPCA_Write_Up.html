<!DOCTYPE html>

<!-- The point of this file is to write up my findings on PCA and NBA team shot distributions -->
<!-- Written by Matthew Osborne -->

<html>
    <head>
        <meta charset="utf-8">
        <title>
            Working Title
        </title>
        <script src="https://d3js.org/d3.v5.min.js"></script>
        <style type="text/css">
            #pca:hover {
                fill: red;
            }

            p {
              font-size: 20px;
              padding-left: 20px;
            }

            h1,h2,h3,h4 {
              padding-left: 20px;
            }

            .line {
                fill: none;
                stroke: black;
                stroke-width: 3;
            }

            table{
              border-collapse: collapse;
              width: 100%;
            }

            th{
              border-bottom: 1px solid;
              padding-right: 15px;
              text-align: left;
              font-size: 24px;
            }

            td{
              text-align: left;
              padding-right: 15px;
              text-align: left;
              font-size: 18px;
            }

            tr:hover {background-color: #A9A9A9;}
		</style>
    </head>
    <body>
        <h1 id="title">
            Working Title
        </h1>
        <h3 id="author">
            Matthew Osborne
        </h3>

        <div id = "writing" style = "width: auto; max-width: 1300px;">
          <p style = "font-size:40px;">
            <q>What these youngbloods have to understand
            is that this game has always been, and will always be, about buckets.</q>
            -Bill Russell
          </p>

          <p>
            Throughout the 2018-19 regular season NBA teams took, on average,
            about 89 shots per game, that's less than 23 a quarter.  In a game
            all about buckets, there really aren't many to go around. With shots
            being such a limited resource, their allocation can (and already has)
            greatly alter(ed) the game as we know it.
          </p>

          <p>
            Ever since the advent of Moreyball there's been a deluge of takes on
            the shift towards the three heavy offense. Now, the point of this post is
            not to be the Kent Brockman of threes - I for one welcome our new
            three point overlords! - nor wax poetic about behemoths methodically
            backing eachother down in the post. Rather, this post will introduce a novel
            way of examining the distribution of a team's shots around the court.
            In particular, a very popular data science technique, principal
            components analysis (PCA), will be applied to raw shot distribution
            data.
          </p>

          <h2>The Data</h2>

          <p>
            The NBA began accurately tracking the x,y position of every shot taken
            during a game back in the 2000-01 regular season. Using the python package
            <a href = "https://github.com/swar/nba_api">nba_api</a> this data can
            be collected to be analyzed. Every single post up, fade-away jumper,
            or step-back three taken occurs in one of 15 sections of a court,
            outlined below.
          </p>


          <div id = "court-holder" style = "width:1300px; margin:auto; float:left;">
            <div id = "court-image" style = "width:500px; margin:auto; float:left;">
              <img src="test.png" alt="Shot Zones" style = "width:500px;">
            </div>
            <div id = "court-table" style = "margin:auto; float:left;">
              <table style="width:100%">
              <tr >
                <th>ID</th>
                <th>Zone Name</th>
              </tr>
              <tr>
                <td>1</td>
                <td>Restricted Area</td>
              </tr>
              <tr>
                <td>2</td>
                <td>In the Paint, Center</td>
              </tr>
              <tr>
                <td>3</td>
                <td>In the Paint, Left</td>
              </tr>
              <tr>
                <td>4</td>
                <td>In the Paint, Right</td>
              </tr>
              <tr>
                <td>5</td>
                <td>Mid-Range, Left</td>
              </tr>
              <tr>
                <td>6</td>
                <td>Mid-Range, Right</td>
              </tr>
              <tr>
                <td>7</td>
                <td>Mid-Range, Center-Left</td>
              </tr>
              <tr>
                <td>8</td>
                <td>Mid-Range, Center-Right</td>
              </tr>
              <tr>
                <td>9</td>
                <td>Mid-Range, Center</td>
              </tr>
              <tr>
                <td>10</td>
                <td>Left Corner 3</td>
              </tr>
              <tr>
                <td>11</td>
                <td>Right Corner 3</td>
              </tr>
              <tr>
                <td>12</td>
                <td>Above the Break 3, Left</td>
              </tr>
              <tr>
                <td>13</td>
                <td>Above the Break 3, Right</td>
              </tr>
              <tr>
                <td>14</td>
                <td>Above the Break 3, Center</td>
              </tr>
              <tr>
                <td>15</td>
                <td>Backcourt</td>
              </tr>
            </table>
            </div>
      </div>


        <p>
          With the shot data from the NBA's official stats, each atttempt can be
          classified as occurring in one of these 15 zones. A team's shot zone distribution
          can then be created by taking the percentage of a team's total attempts that
          occurred in each zone. For example, here is the shot distribution for the
          2018-19 World Champion Toronto Raptors.
        </p>

        <div id = "toronto-table" style = "width:1300px; padding-left:20px; padding-bottom: 10px; margin:auto; float:left;">
          <table style="width:500px;">
            <tr >
              <th>Zone</th>
              <th>% of Toronto's Attempts</th>
            </tr>
            <tr>
              <td>Restricted Area</td>
              <td>32.16</td>
            </tr>
            <tr>
              <td>In the Paint, Center</td>
              <td>14.31</td>
            </tr>
            <tr>
              <td>In the Paint, Left</td>
              <td>0.55</td>
            </tr>
            <tr>
              <td>In the Paint, Right</td>
              <td>0.68</td>
            </tr>
            <tr>
              <td>Mid-Range, Left</td>
              <td>3.38</td>
            </tr>
            <tr>
              <td>Mid-Range, Right</td>
              <td>3.75</td>
            </tr>
            <tr>
              <td>Mid-Range, Center-Left</td>
              <td>1.74</td>
            </tr>
            <tr>
              <td>Mid-Range, Center-Right</td>
              <td>2.53</td>
            </tr>
            <tr>
              <td>Mid-Range, Center</td>
              <td>3.01</td>
            </tr>
            <tr>
              <td>Left Corner 3</td>
              <td>5.52</td>
            </tr>
            <tr>
              <td>Right Corner 3</td>
              <td>5.31</td>
            </tr>
            <tr>
              <td>Above the Break 3, Left</td>
              <td>9.16</td>
            </tr>
            <tr>
              <td>Above the Break 3, Right</td>
              <td>9.71</td>
            </tr>
            <tr>
              <td>Above the Break 3, Center</td>
              <td>7.98</td>
            </tr>
            <tr>
              <td>Backcourt</td>
              <td>0.22</td>
            </tr>
          </table>
        </div>



  <p>
    These shot distributions provide a snapshot of how a team allocated its limited
    resource in a particular season. This is great, however, it is slightly unmanageable
    to track how 15 numbers change over the course of 20 or so seasons. It would
    be nice if we could reduce that to one or two numbers to track over time.
  </p>

  <h2>
    PCA in the NBA
  </h2>

    <p>
      Enter Principal Components Analysis (PCA). PCA takes high dimensional data sets
      and reduces them to a more manageable number of dimensions. For example, PCA can
      take these 15 percentages and boil them down to just 1 or 2 numbers \< insert
      super script here to link to how PCA works\>. Running the 2018-19 Toronto Raptors'
      shot distribution through PCA produces the following two values: (0.093,-0.030).
      Doing this for every team's shot distribution from the 2000-01 to the 2018-19
      seaons produces the following plot, where a team's first PCA value is on the
      horizontal axis, and the second on the vertical.
    </p>
    <!--This holds the main plot--->
    <div id = "main-holder" style = "width:1300px; height:800px; margin:auto; float:left; padding-left:20px;">
        <div id = "main-plot" style = "width:950px; height:800px; float:left;">
        </div>
        <div id = "side-text" style = "width:350px; height:400px; float:right;">
            <div id = "buttons" style = "width:350px; height:50px; float:top;">
                <p>Highlighted Season: <span id = "season-button"></span> <br>
                    Highlighted Team: <span id = "team-button"></span>
                </p>
            </div>
            <div id = "text" style = "width:300px; height:350px; float:bottom;">
                <p style = "font-size:125%"><strong>Season: </strong> <span id = "Season" style= "color:white;"></span>
                <br>
                <strong>Team: </strong> <span id = "Team" style = "color:white;"></span><br>
                <span style = "font-size:90%">
                Shots in the Paint: <span id = "paint"></span> <br>
                Shots from Midrange: <span id = "midrange"></span> <br>
                Shots from 3: <span id = "three"></span></span>
                </p>
            </div>
        </div>
    </div>

    <p>
      <a href = "https://www.youtube.com/watch?v=TdUsyXQ8Wrs">Run, don't walk from
        the Blob of data points!</a> Don't worry this blob can make sense. When
        data is put through PCA, something called principal component vectors
        are also produced. These explain what the values mean in terms of the original
        data set. Here are the first two component vectors:
    </p>

    <div id = "component-vectors" style = "width:1250px; float:left; margin:auto;padding-left:20px; padding-bottom:20px;">
      <div id = "first-component" style = "width:600px; float:left; margin:auto;">
        <table style="width:570px;">
          <tr >
            <th>Zone</th>
            <th>First Principal Component Score</th>
          </tr>
          <tr>
            <td>
              Mid-Range, Left
            </td>
            <td>
              -0.581
            </td>
          </tr>
          <tr>
            <td>
              Mid-Range, Right
            </td>
            <td>
              -0.483
            </td>
          </tr>
          <tr>
            <td>
              Mid-Range, Center-Right
            </td>
            <td>
              -0.159
            </td>
          </tr>
          <tr>
            <td>
              Mid-Range, Center-Left
            </td>
            <td>
              -0.150
            </td>
          </tr>
          <tr>
            <td>
              Mid-Range, Center
            </td>
            <td>
              -0.055
            </td>
          </tr>
          <tr>
            <td>
              In the Paint, Left
            </td>
            <td>
              -0.020
            </td>
          </tr>
          <tr>
            <td>
              In the Paint, Right
            </td>
            <td>
              -0.012
            </td>
          </tr>
          <tr>
            <td>
              Backcourt
            </td>
            <td>
              0.002
            </td>
          </tr>
          <tr>
            <td>
              In the Paint, Center
            </td>
            <td>
              0.057
            </td>
          </tr>
          <tr>
            <td>
              Left Corner 3
            </td>
            <td>
              0.111
            </td>
          </tr>
          <tr>
            <td>
              Right Corner 3
            </td>
            <td>
              0.113
            </td>
          </tr>
          <tr>
            <td>
              Above the Break 3, Center
            </td>
            <td>
              0.259
            </td>
          </tr>
          <tr>
            <td>
              Restricted Area
            </td>
            <td>
              0.297
            </td>
          </tr>
          <tr>
            <td>
              Above the Break 3, Right
            </td>
            <td>
              0.307
            </td>
          </tr>
          <tr>
            <td>
              Above the Break 3, Left
            </td>
            <td>
              0.314
            </td>
          </tr>
        </table>
      </div>
      <div id = "second-component" style = "width:600px; float:left; margin:auto;">
        <table style="width:600px;">
          <tr >
            <th>Zone</th>
            <th>Second Principal Component Score</th>
          </tr>
          <tr>
            <td>
              Above the Break 3, Left
            </td>
            <td>
              -0.243
            </td>
          </tr>
          <tr>
            <td>
              Above the Break 3, Right
            </td>
            <td>
              -0.232
            </td>
          </tr>
          <tr>
            <td>
              Above the Break 3, Center
            </td>
            <td>
              -0.208
            </td>
          </tr>
          <tr>
            <td>
              In the Paint, Center
            </td>
            <td>
              -0.138
            </td>
          </tr>
          <tr>
            <td>
              Left Corner 3
            </td>
            <td>
              -0.092
            </td>
          </tr>
          <tr>
            <td>
              Right Corner 3
            </td>
            <td>
              -0.073
            </td>
          </tr>
          <tr>
            <td>
              In the Paint, Left
            </td>
            <td>
              -0.015
            </td>
          </tr>
          <tr>
            <td>
              In the Paint, Right
            </td>
            <td>
              -0.013
            </td>
          </tr>
          <tr>
            <td>
              Mid-Range, Center
            </td>
            <td>
              -0.010
            </td>
          </tr>
          <tr>
            <td>
              Backcourt
            </td>
            <td>
              0.001
            </td>
          </tr>
          <tr>
            <td>
              Mid-Range, Left
            </td>
            <td>
              0.010
            </td>
          </tr>
          <tr>
            <td>
              Mid-Range, Center-Left
            </td>
            <td>
              0.024
            </td>
          </tr>
          <tr>
            <td>
              Mid-Range, Center-Right
            </td>
            <td>
              0.044
            </td>
          </tr>
          <tr>
            <td>
              Mid-Range, Right
            </td>
            <td>
              0.048
            </td>
          </tr>
          <tr>
            <td>
              Restricted Area
            </td>
            <td>
              0.897
            </td>
          </tr>
        </table>
      </div>
    </div>

    <p>
      What do these two vectors mean? For either vector, positive vector entries
      (rows in the table) correspond to more positive principal component values.
      For example a team with 100% of their shots from Above the Break 3, Left will
      have as large a first principal component value as possible because that is the
      most positive row of the first principal component vector table. On the other
      hand a team that shot 100% of their shots from Mid-Range Left will have as negative
      a first principal component value as possible because that is the most negative
      row of the first principal component vector table.
    </p>

    <p>
      In the first principal component vector the negative court areas are those
      that have been deemed "less efficient", the mid-range, while the most positive
      court areas are downtown and in the restricted area. So a team's first
      principal component value captures how much often that team took less efficient
      shots. In terms of the earlier plot, more efficient teams step to the right
      less efficient teams to the left please.
    </p>

    <p>
      Below is a plot that demonstrates what was explained above. Coloring each dot
      by the team's percentage of total shots taken from three or the
      restricted area paints a clear picture. Going from left to right on the PCA
      plot increases the percentage of total attempts from downtown or under the
      basket. A team's first PCA value captures the "efficiency" of their shot
      selection.
    </p>

    <!-- This holds the efficiency plot --->
    <div id = "eff-div", style = "width:1300px; height:650px; margin:auto; float:left; padding-left:20px;">
        <div id = "eff-plot" style = "width:800px; height:650px; margin:auto; float:left;">
        </div>
        <div id = "eff-legend" style = "width:150px; height:650px; margin:auto; float:left;">
        </div>
    </div>

    <p>
      The second PCA value captures how a team distributes a shot in those
      more efficient zones. Three point zones are the most negative in the second
      principal component vector, while the restricted area is overwhelmingly the
      most positive. Teams that live under the rim will be found near the top of
      the PCA value plot, while teams <a href = "https://www.cleveland.com/entertainment/2016/04/austin_carr_catch_phrases.html">
      shooting it from deep in the [approximate name of arena where game is being
      played]</a> can be found near the bottom. Check it out in the following two plots.
    </p>

    <!-- This holds the three plot --->
    <div id = "three-div", style = "width:1300px; height:650px; margin:auto; float:left; padding-left:20px;">
        <div id = "three-plot" style = "width:800px; height:650px; margin:auto; float:left;">
        </div>
        <div id = "three-legend" style = "width:100px; height:650px; margin:auto; float:left;">
        </div>
    </div>

    <!-- This holds the close plot --->
    <div id = "close-div", style = "width:1300px; height:650px; margin:auto; float:left; padding-left:20px;">
        <div id = "close-plot" style = "width:800px; height:650px; margin:auto; float:left;">
        </div>
        <div id = "close-legend" style = "width:100px; height:650px; margin:auto; float:left;">
        </div>
    </div>

    <p>
      These PCA scores have value in tracking the how a team allocates its shot
      attempts around the court. How can they help explain how a team or even
      the association has changed over the last 20 seasons.
    </p>

    <h2>
      The Great Migration from Left to Right
    </h2>

    <p>
      With the success of the Houston Rockets' three heavy offense, much has been
      made of the NBA's transition into a gun slinger league. Mathematically this
      transition does make sense. According to research performed by NBA analyst
      and geographer <a href = "https://www.espn.com/nba/story/_/id/25459090/carmelo-anthony-last-great-american-ball-hog">
      Kirk Goldsberry</a>, the restricted area and just beyond the arc are the
      only spots on the court with a positive return on investment, meaning the
      only places where the expected points per shot is above 1. It is pretty straight
      forward, 23 shots from spots with expected points per shot above 1 should
      net more than 23 points, 23 shots from spots with expected points per shot
      below 1 should net you less than 23 points. As a reminder, the team with
      more points typically wins the game.
    </p>

    <p>
      It's a copycat league, so as Houston started to have success against the
      game's Goliath State Warriors, other teams started to follow suit devising
      shot distributions that primarily feature these "efficient" zones of the
      court. If this is true, it should be reflected in the PCA chart. Click the
      'Start!' button of the graphic below to see how PCA values have progressed
      over the last 20 seasons.
    </p>

    <!--This holds the time lapse plot--->
    <div id = "time-holder" style = "width:1300px; height:700px; margin:auto; float:left; padding-left:20px;">
        <div id = "time-lapse-plot" style = "width:900px; height:750px; float:left;">
        </div>
        <div id = "time-side" style = "width:100px; height 650px; float:left;">
            <div id = "time-button" style = "width:100px; height 650px; position: relative; top:60px; left: -100px;">
                <button type="button" style = "font-size:16px; padding: 5px 2px;">Start!</button>
            </div>
        </div>
    </div>

    <p>
      And <a href = "https://www.youtube.com/watch?v=rjA5A86V6SY">there it is.</a>
      As the seasons progress there is a clear shift from the left of the chart
      (the area where less efficient midrange heavy teams live), to the right of
      the chart (where the threes and restricted areas roam), as expected.
    </p>

    <h3>
      If it Ain't Broke Don't Fix it
    </h3>

    <p>
      Is this the all is lost moment for mid-range and post play? Maybe, but maybe
      not. The Warriors have the most prolific shooting duo in history,
      <a href = "https://www.youtube.com/watch?v=JTA5aBmmYJg">Steph</a> and
      <a href = "https://www.youtube.com/watch?v=uRE1X_DXDp0">Klay</a>, so it's
      a no brainer that they take advantage of this more efficient approach, right?
      Well yes, but actually no. Click the 'Start!' button on the below plot to
      watch Golden State's progression since 2014 compared to the rest of the
      NBA.
    </p>

    <!--Warriors Plot div--->
    <div id = "warriors-div", style = "width:1300 px; height: 600px; margin: auto; float:left; ">
        <div id = "warriors-plot" style = "width: 800px; height: 600px; margin: auto; float: left;">
        </div>
        <div id = "warriors-side" style = "width: 500px; height: 600px; margin: auto; float: right;">
          <div id = "warriors-button-div" style = "margin: auto; position: relative; top:50px; left: -50px;">
            <button id="warriors-button" style = "font-size:16px; padding: 5px 2px;">Start!</button>

            <p style = "font-size:24px;"><b>Number of Teams <br> Right of The Warriors</b> <br> <br>
              2014-15: <span id = "fourteen"></span> <br>
              2015-16: <span id = "fifteen"></span> <br>
              2016-17: <span id = "sixteen"></span> <br>
              2017-18: <span id = "seventeen"></span> <br>
              2018-19: <span id = "eighteen"></span>
            </p>

          </div>
        </div>
    </div>

    <p>
      The Warriors start off their dynasty run ahead of the crowd when it comes to
      shot distribution. In their record breaking 2015-16 Season they placed their shots
      more "efficiently" than all but two teams in the league, with over 35% of their shots
      coming from 3 (second to only the Houston Rockets). However, they then became
      stagnant. For the seasons following 2016 they essentially stand still while
      the rest of the association move further and further to the right. GSW ended
      the 2018-19 season as the team with the second highest of shots from mid-range
      (second only to the 3 detesting <a href = "https://www.youtube.com/watch?v=JR5c4ZinP9M">Spurs</a>).
    </p>

    <p>
      But the Warriors went 3 for 5 in the NBA finals, and probably 4 for 5 if either
      of Klay or KD don't get hurt (sorry Raptors fans, but its true). So
      does shot distribution relative to the rest of the league even matter? If
      a team features 4 future hall of famers, probably not so much, especially when
      2 (possibly <a href = "https://www.youtube.com/watch?v=YVsah5EBKuI">3</a>) are
      hall of famers because of their ability to make efficient shots. Klay and Curry
      are so good at converting threes that their team can get away without taking
      as many as the rest of the NBA.
    </p>

    <p>
      It actually might now be broke though. Heading into the 2019-20 season the
      Warriors will have to replace Kevin Durant and Klay Thompson with D'Angelo
      Russell. While D'Angelo is a rising star, it is insanity to think Steve Kerr
      could just slot him into the same offensive scheme and expect similar results.
      It seems likely they will make a shift toward the right of the PCA chart.
    </p>

    <h2>
      Taking the Leap
    </h2>

    <p>
      Not only do these PCA coordinates capture the NBA wide transition in NBA,
      but they can help describe the effect of particular moves a team makes between
      seasons.
    </p>

    <h3>
      Houston We Have a Harden
    </h3>

    <p>
      No team is more renowned (or even reviled) for their reliance on 3s and layups
      than the Houston Rockets. While these more "efficent" shot distributions have
      been deemed Moreyball the PCA plot reveals that it was not Daryl that led
      this transition. Morey has been GM of the Rockets since 2007, but Houston
      did not significantly change its shot distribution until a few years later.
      Hover over the below plot to see what team events do coincide with noticeable
      changes in shot distribution.
    </p>

    <!--Rockets Plot div--->
    <div id = "rockets-div", style = "width:1300px; height: 600px; margin: auto; float:left; padding-left:20px;">
        <div id = "rockets-plot" style = "width: 1300px; height: 600px; margin: auto; float: left;">
        </div>
    </div>

    <p>
      Maybe a better name would be Hardenball? Now it could be argued that Daryl
      discovered the competitive advantage that 3 > 2 and thus trading for a player
      that is perfect for such an offense, and then hired a coach that would take
      that offense to the extreme. But, it is equally likely that Morey just traded
      for a good player that was (stupidly) available, and then built an offensive
      system around said player that would help him, and the team, succeed. Either
      way, it's clear that it was not what we call Moreyball until James Harden
      touched down in Houston.
    </p>

    <h3>
      The Bucks Start With Giannis
    </h3>



        <!--Bucks Plot div--->
        <div id = "bucks-div", style = "width:800 px; height: 600px; margin: auto; float:left; padding-left:20px;">
            <div id = "bucks-plot" style = "width: 800px; height: 600px; margin: auto; float: left;">
            </div>
        </div>

        <!--Nets Plot div--->
        <div id = "nets-div", style = "width:800 px; height: 600px; margin: auto; float:left; padding-left:20px;">
            <div id = "nets-plot" style = "width: 800px; height: 600px; margin: auto; float: left;">
            </div>
        </div>

        <!--76ers Plot div-->
        <div id = "sixers-div", style = "width:800 px; height: 600px; margin: auto; float:left; padding-left:20px;">
            <div id = "sixers-plot" style = "width: 800px; height: 600px; margin: auto; float: left;">
            </div>
        </div>



    <!--Makes all of the plots--->
		<script type="text/javascript">
            d3.csv("Data/Team_Shots_by_Zone.csv").then(function(data){
              /* Main Plot */
              // Variables for the main plot
              var main_width = 950
              var main_height = 750
              var main_padding = 70
              var padding = 50

              // svg for the main plot
              var svg = d3.select("#main-plot")
                              .append("svg")
                              .attr("width", main_width)
                              .attr("height", main_height);

              /* Time Lapse Plot */
              // Variables for the time lapse plot
              var time_width = 800
              var time_height = 650

              // svg for the time lapse plot
              var time_svg = d3.select("#time-lapse-plot")
                                  .append("svg")
                                  .attr("width",time_width)
                                  .attr("height",time_height);

              time_svg.append("text")
                          .attr("x",70)
                          .attr("y",85)
                          .attr("font-size","24px")
                          .attr("id","season-text")
                          .text("Season:");

              /* Three Plot */
              var three_width = 700
              var three_height = 550
              var three_legend_svg_width = 200
              var three_legend_svg_height = 650
              var three_legend_width = 25
              var three_legend_height = 500


              var three_svg = d3.select("#three-plot")
                                  .append("svg")
                                  .attr("width",three_width)
                                  .attr("height",three_height);

              var three_legend_svg = d3.select("#three-legend")
                                          .append("svg")
                                          .attr("width", three_legend_svg_width)
                                          .attr("height", three_legend_svg_height)
                                          .style("position","relative")
                                          .style("left",-120);

              /* Close Plot */
              var close_width = 700
              var close_height = 550
              var close_legend_svg_width = 200
              var close_legend_svg_height = 650
              var close_legend_width = 25
              var close_legend_height = 500

              var close_svg = d3.select("#close-plot")
                                  .append("svg")
                                  .attr("width",close_width)
                                  .attr("height",close_height);

              var close_legend_svg = d3.select("#close-legend")
                                          .append("svg")
                                          .attr("width", close_legend_svg_width)
                                          .attr("height", close_legend_svg_height)
                                          .style("position","relative")
                                          .style("left",-120);


              /* Efficiency Plot */
              var eff_width = 700
              var eff_height = 550
              var eff_legend_svg_width = 200
              var eff_legend_svg_height = 650
              var eff_legend_width = 25
              var eff_legend_height = 500

              var eff_svg = d3.select("#eff-plot")
                                  .append("svg")
                                  .attr("width",close_width)
                                  .attr("height",close_height);


              var eff_legend_svg = d3.select("#eff-legend")
                                          .append("svg")
                                          .attr("width", eff_legend_svg_width)
                                          .attr("height", eff_legend_svg_height)
                                          .style("position","relative")
                                          .style("left",-120);




              var buffer = .01



              /* First the main plot */
              // xscale
              var xScale = d3.scaleLinear()
                              .domain([d3.min(data, function(d){return parseFloat(d.pca_1);}) - buffer, d3.max(data, function(d){return parseFloat(d.pca_1);}) + buffer])
                              .range([main_padding, main_width - main_padding]);

              // yscale
              var yScale = d3.scaleLinear()
                              .domain([d3.min(data, function(d){return parseFloat(d.pca_2);}) - buffer, d3.max(data, function(d){return parseFloat(d.pca_2);}) + buffer])
                              .range([main_height - main_padding, main_padding]);

              // make axes
              var xAxis = d3.axisBottom(xScale);

              var yAxis = d3.axisLeft(yScale);


              // This function draws the pca values for each team
              var drawCircles = function(){
                  var circles = svg.selectAll("circle")
                                  .data(data)
                                  .enter()
                                  .append("circle");

                  circles.attr("cx", function(d){
                              return xScale(parseFloat(d.pca_1));
                          })
                          .attr("cy", function(d){
                              return yScale(parseFloat(d.pca_2));
                          })
                          .attr("r", 5)
                          .attr("fill","black")
                          .attr("stroke","black")
                          .attr("stroke-width",2)
                          .attr("id","pca")
                          .attr("opacity",.8)
                          .on("mouseover", function(d){
                                  d3.select("#Team")
                                      .style("color", "black")
                                      .text(d.TEAM_NAME);

                                  d3.select("#Season")
                                      .style("color", "black")
                                      .text(d.Season);

                                  d3.select("#paint")
                                      .style("color", "black")
                                      .text(function(){
                                          var perc = parseFloat(d['CLOSE_PERC_OF_TOT'])

                                          perc = 100 * perc

                                          perc = perc.toFixed(2).toString()

                                          return perc.concat("%")
                                      });

                                  d3.select("#midrange")
                                      .style("color", "black")
                                      .text(function(){
                                          var perc = parseFloat(d['MID_PERC_OF_TOT'])

                                          perc = 100 * perc

                                          perc = perc.toFixed(2).toString()

                                          return perc.concat("%")
                                      });

                                  d3.select("#three")
                                      .style("color", "black")
                                      .text(function(){
                                          var perc = parseFloat(d['3_PERC_OF_TOT'])

                                          perc = 100 * perc

                                          perc = perc.toFixed(2).toString()

                                          return perc.concat("%")
                                      });
                          })
                          .on("mouseout", function(d){
                                  d3.select("#Team")
                                      .style("color", "white")
                                      .text("");

                                  d3.select("#Season")
                                      .style("color","white")
                                      .text("");

                                  d3.select("#paint")
                                      .style("color","white")
                                      .text("");

                                  d3.select("#midrange")
                                      .style("color","white")
                                      .text("");

                                  d3.select("#three")
                                      .style("color","white")
                                      .text("");
                          });
              }

                // This function updates the circles when we slect season/team
                var updateCircles = function(){
                    var season_sel = document.getElementById('season-sel');
                    var team_sel = document.getElementById('team-sel');

                    var season = season_sel.options[season_sel.selectedIndex].value;
                    var team_id = team_sel.options[team_sel.selectedIndex].value;

                    if (season === "All"){
                        if (team_id === "All"){
                            svg.selectAll("circle")
                                .data(data)
                                .transition()
                                .attr("opacity",.8)
                                .duration(2000);
                        } else{
                            svg.selectAll("circle")
                                .data(data)
                                .filter(function(d){return d.TEAM_ID != team_id;})
                                .transition("transition1")
                                .attr("opacity",.05);

                            svg.selectAll("circle")
                                .data(data)
                                .filter(function(d){return d.TEAM_ID === team_id;})
                                .transition("transition2")
                                .duration(1000)
                                .attr("opacity",.9);
                        }
                    } else{
                        if(team_id === "All"){
                            svg.selectAll("circle")
                                .data(data)
                                .filter(function(d){return d.Season != season;} )
                                .transition("transition1")
                                .attr("opacity",.05);

                            svg.selectAll("circle")
                                .data(data)
                                .filter(function(d){return d.Season === season;})
                                .transition("transition2")
                                .duration(1000)
                                .attr("opacity", .9);
                        } else{
                            svg.selectAll("circle")
                                .data(data)
                                .filter(function(d){return (d.Season != season) || (d.TEAM_ID != team_id);} )
                                .transition("transition1")
                                .attr("opacity",.05);

                            svg.selectAll("circle")
                                .data(data)
                                .filter(function(d){return (d.Season === season) && (d.TEAM_ID == team_id);})
                                .transition("transition2")
                                .duration(1000)
                                .attr("opacity",.9);
                        }
                    }

                }


                // put in the season dropdown button
                var seasonDropdown = d3.select("#season-button")
                                        .insert("select", "svg")
                                        .attr("id","season-sel")
                                        .on("change", updateCircles);



                seasonDropdown.selectAll("option")
                                .data(d3.map(data, function(d){return d.Season;}).keys())
                                .enter()
                                .append("option")
                                .text(function(d){return d;})
                                .attr("value",function(d){return d;});

                seasonDropdown.append("option")
                                .text("All")
                                .attr("value", "All")
                                .property("selected","All");

                // put in the team dropdown
                var teamDropdown = d3.select("#team-button")
                                        .insert("select","svg")
                                        .attr("id","team-sel")
                                        .on("change",updateCircles);

                teamDropdown.selectAll("option")
                                .data(data)
                                .enter()
                                .filter(function(d){return d.Season === "2018-19";})
                                .append("option")
                                .text(function(d){return d.TEAM_NAME;})
                                .attr("value",function(d){return d.TEAM_ID;});

                teamDropdown.append("option")
                            .text("All")
                            .attr("value","All")
                            .property("selected","All");


                // append the axes to the plot
                svg.append("g")
                    .style("font-size",16)
                    .attr("transform", "translate(0, " + (main_height - main_padding) +")")
                    .call(xAxis);

                svg.append("g")
                    .style("font-size",16)
                    .attr("transform", "translate(" + main_padding  + ",0)")
                    .call(yAxis);

                svg.append("text")
                    .attr("transform",
                          "translate(" + (main_width/2) + " ," +
                          (main_height - 20) + ")")
                    .style("text-anchor", "middle")
                    .attr("font-size",24)
                    .text("First PCA Value");

                svg.append("text")
                    .attr("transform", "rotate(-90)")
                    .attr("y", -7)
                    .attr("x",0 - (main_height / 2))
                    .attr("dy", "1em")
                    .attr("font-size",24)
                    .style("text-anchor", "middle")
                    .text("Second PCA Value");

                svg.append("text")
                    .attr("x", main_padding + 10)
                    .attr("y", main_padding + 10)
                    .attr("font-size",18)
                    .text("Hover over a dot to");

                svg.append("text")
                    .attr("x", main_padding + 10)
                    .attr("y", main_padding + 30)
                    .attr("font-size",18)
                    .text("highlight the team it represents");


                // draw the circles onto the svg
                drawCircles();





                /* time lapse plot */
                // Make the x scale
                var time_xScale = d3.scaleLinear()
                                .domain([d3.min(data, function(d){return parseFloat(d.pca_1);}) - buffer, d3.max(data, function(d){return parseFloat(d.pca_1);}) + buffer])
                                .range([padding, time_width - padding]);

                // Make the y scale
                var time_yScale = d3.scaleLinear()
                                .domain([d3.min(data, function(d){return parseFloat(d.pca_2);}) - buffer, d3.max(data, function(d){return parseFloat(d.pca_2);}) + buffer])
                                .range([time_height - padding, padding]);

                // make the x axis
                var time_xAxis = d3.axisBottom(time_xScale);

                // make the y axis
                var time_yAxis = d3.axisLeft(time_yScale);

                // put on the x axis
                time_svg.append("g")
                    .attr("transform", "translate(0, " + (time_height - padding) +")")
                    .call(time_xAxis);

                // put on the y axis
                time_svg.append("g")
                    .attr("transform", "translate(" + padding + ",0)")
                    .call(time_yAxis);

                time_svg.append("text")
                        .attr("transform",
                              "translate(" + (time_width/2) + " ," +
                              (time_height - 10) + ")")
                        .style("text-anchor", "middle")
                        .attr("font-size",18)
                        .text("First PCA Value");

                time_svg.append("text")
                        .attr("transform", "rotate(-90)")
                        .attr("y", 0-5)
                        .attr("x",0 - (time_height / 2))
                        .attr("dy", "1em")
                        .attr("font-size",18)
                        .style("text-anchor", "middle")
                        .text("Second PCA Value");

                // This function runs through the season sequence
                var seasonSequence = function(){
                    var circles = time_svg.selectAll("circle")
                                            .data(data)
                                            .enter()
                                            .append("circle");

                    circles.attr("cx", function(d){
                                return time_xScale(parseFloat(d.pca_1));
                            })
                            .attr("cy", function(d){
                                return time_yScale(parseFloat(d.pca_2));
                            })
                            .attr("r", 5)
                            .attr("fill","black")
                            .attr("id","pca")
                            .attr("opacity",.01);

                   var seasons = d3.map(data, function(d){return d.Season;}).keys();

                   var seasonsLength = seasons.length;

                   time_svg.select("#season-text")
                             .transition("text")
                             .delay(0)
                             .duration(0)
                             .text("Season:");

                   time_svg.selectAll("circle")
                             .transition("circles")
                             .delay(0)
                             .duration(0)
                             .attr("opacity",0);

                   for (var i = 0; i < seasonsLength; i++) {
                      var delay = 1000;
                      var dur = 300;

                      time_svg.selectAll("#season-text")
                                .transition("text")
                                .delay(delay*i)
                                .text("Season: " + seasons[i]);

                      time_svg.selectAll("circle")
                                    .data(data)
                                    .filter(function(d){return d.Season != seasons[i];})
                                    .transition("circles")
                                    .delay( (delay*i) )
                                    .attr("opacity",.01)
                                    .duration(dur);

                      time_svg.selectAll("circle")
                                    .data(data)
                                    .filter(function(d){return d.Season === seasons[i];})
                                    .transition("circles")
                                    .delay( (delay*i) )
                                    .duration(dur)
                                    .attr("opacity",.9);
                    }

                    time_svg.select("#season-text")
                              .transition("text")
                              .delay(delay*(seasonsLength) + 500)
                              .text("2000-01 VS. 2018-19");

                    time_svg.selectAll("circle")
                            .data(data)
                            .filter(function(d){return d.Season === "2000-01";})
                            .transition("circles")
                            .delay(delay*seasonsLength + 500)
                            .duration(dur)
                            .attr("opacity",.9);

                }

                // this adds the on click function to the time-lapse button
                d3.select("#time-button")
                    .on("click",seasonSequence);

                /* Three plot */
                // Make the x scale
                var three_xScale = d3.scaleLinear()
                                .domain([d3.min(data, function(d){return parseFloat(d.pca_1);}) - buffer, d3.max(data, function(d){return parseFloat(d.pca_1);}) + buffer])
                                .range([padding, three_width - padding]);

                // Make the y scale
                var three_yScale = d3.scaleLinear()
                                .domain([d3.min(data, function(d){return parseFloat(d.pca_2);}) - buffer, d3.max(data, function(d){return parseFloat(d.pca_2);}) + buffer])
                                .range([three_height - padding, padding]);

                // make the x axis
                var three_xAxis = d3.axisBottom(three_xScale);

                // make the y axis
                var three_yAxis = d3.axisLeft(three_yScale);

                // put on the x axis
                three_svg.append("g")
                    .attr("transform", "translate(0, " + (three_height - padding) +")")
                    .call(three_xAxis);

                // put on the y axis
                three_svg.append("g")
                    .attr("transform", "translate(" + padding + ",0)")
                    .call(three_yAxis);

                /* Close Plot */
                // Make the x scale
                var close_xScale = d3.scaleLinear()
                                .domain([d3.min(data, function(d){return parseFloat(d.pca_1);}) - buffer, d3.max(data, function(d){return parseFloat(d.pca_1);}) + buffer])
                                .range([padding, close_width - padding]);

                // Make the y scale
                var close_yScale = d3.scaleLinear()
                                .domain([d3.min(data, function(d){return parseFloat(d.pca_2);}) - buffer, d3.max(data, function(d){return parseFloat(d.pca_2);}) + buffer])
                                .range([close_height - padding, padding]);

                // make the x axis
                var close_xAxis = d3.axisBottom(close_xScale);

                // make the y axis
                var close_yAxis = d3.axisLeft(close_yScale);

                // put on the x axis
                close_svg.append("g")
                    .attr("transform", "translate(0, " + (close_height - padding) +")")
                    .call(close_xAxis);

                // put on the y axis
                close_svg.append("g")
                    .attr("transform", "translate(" + padding + ",0)")
                    .call(close_yAxis);

                close_svg.append("text")
                        .attr("transform",
                              "translate(" + (close_width/2) + " ," +
                              (close_height - 10) + ")")
                        .style("text-anchor", "middle")
                        .attr("font-size",18)
                        .text("First PCA Value");

                close_svg.append("text")
                        .attr("transform", "rotate(-90)")
                        .attr("y", 0-5)
                        .attr("x",0 - (close_height / 2))
                        .attr("dy", "1em")
                        .attr("font-size",18)
                        .style("text-anchor", "middle")
                        .text("Second PCA Value");

                three_svg.append("text")
                        .attr("transform",
                              "translate(" + (close_width/2) + " ," +
                              (close_height - 10) + ")")
                        .style("text-anchor", "middle")
                        .attr("font-size",18)
                        .text("First PCA Value");

                three_svg.append("text")
                        .attr("transform", "rotate(-90)")
                        .attr("y", 0-5)
                        .attr("x",0 - (close_height / 2))
                        .attr("dy", "1em")
                        .attr("font-size",18)
                        .style("text-anchor", "middle")
                        .text("Second PCA Value");


                /* Efficiency Plot */
                var effPlot= function(){
                    // Make the x scale
                    var eff_xScale = d3.scaleLinear()
                                    .domain([d3.min(data, function(d){return parseFloat(d.pca_1);}) - buffer, d3.max(data, function(d){return parseFloat(d.pca_1);}) + buffer])
                                    .range([padding, eff_width - padding]);

                    // Make the y scale
                    var eff_yScale = d3.scaleLinear()
                                    .domain([d3.min(data, function(d){return parseFloat(d.pca_2);}) - buffer, d3.max(data, function(d){return parseFloat(d.pca_2);}) + buffer])
                                    .range([eff_height - padding, padding]);

                    // make the x axis
                    var eff_xAxis = d3.axisBottom(eff_xScale);

                    // make the y axis
                    var eff_yAxis = d3.axisLeft(eff_yScale);

                    // put on the x axis
                    eff_svg.append("g")
                        .attr("transform", "translate(0, " + (eff_height - padding) +")")
                        .call(eff_xAxis);

                    // put on the y axis
                    eff_svg.append("g")
                        .attr("transform", "translate(" + padding + ",0)")
                        .call(eff_yAxis);

                    var color = d3.scaleSequential().domain([d3.min(data, function(d){return  parseFloat(d['Restricted_Area-Center(C)_PERC_TOT']) + parseFloat(d['3_PERC_OF_TOT']);}), d3.max(data, function(d){return parseFloat(d['Restricted_Area-Center(C)_PERC_TOT']) + parseFloat(d['3_PERC_OF_TOT']);})])
                                        .interpolator(d3.interpolateInferno);

                    var circles = eff_svg.selectAll("circle")
                                            .data(data)
                                            .enter()
                                            .append("circle");

                    eff_svg.append("text")
                            .attr("transform",
                                  "translate(" + (eff_width/2) + " ," +
                                  (eff_height - 10) + ")")
                            .style("text-anchor", "middle")
                            .attr("font-size",18)
                            .text("First PCA Value");

                    eff_svg.append("text")
                            .attr("transform", "rotate(-90)")
                            .attr("y", 0-5)
                            .attr("x",0 - (eff_height / 2))
                            .attr("dy", "1em")
                            .attr("font-size",18)
                            .style("text-anchor", "middle")
                            .text("Second PCA Value");




                    circles.attr("cx", function(d){
                                return three_xScale(parseFloat(d.pca_1));
                            })
                            .attr("cy", function(d){
                                return three_yScale(parseFloat(d.pca_2));
                            })
                            .attr("r", 8)
                            .attr("fill",function(d){return color(parseFloat(d['Restricted_Area-Center(C)_PERC_TOT']) + parseFloat(d['3_PERC_OF_TOT']));})
                            .attr("stroke","black")
                            .attr("stroke-width",2)
                            .attr("opacity",.95);
                }

                var effLegend = function(){
                    var colorScale = d3.scaleSequential(d3.interpolateInferno)
                                        .domain([0, eff_legend_height])

                    var bars = eff_legend_svg.selectAll("rect")
                        .data(d3.range(eff_legend_height), function(d) { return d; })
                        .enter()
                        .append("rect")
                        .attr("x", 0)
                        .attr("y", function(d, i) { return eff_legend_height - i; })
                        .attr("height", 1)
                        .attr("width", eff_legend_width)
                        .style("fill", function(d, i ) { return colorScale(d); })

                    // yscale
                    var yScale = d3.scaleLinear()
                                    .domain([d3.min(data, function(d){return parseFloat(d['Restricted_Area-Center(C)_PERC_TOT'] + d['3_PERC_OF_TOT']);}), d3.max(data, function(d){return parseFloat(d['Restricted_Area-Center(C)_PERC_TOT'] + d['3_PERC_OF_TOT']);})])
                                    .range([eff_legend_height, 0]);

                    var yAxis = d3.axisRight(yScale);

                    eff_legend_svg.append("g")
                    .attr("transform", "translate(" + eff_legend_width + ",0)")
                    .call(yAxis);

                    eff_legend_svg.append("text")
                            .attr("transform","rotate(-90)")
                            .attr("y", eff_legend_width + 34)
                            .attr("x", 0 - (eff_height/2))
                            .attr("dy", "1em")
                            .attr("font-size",18)
                            .style("text-anchor", "middle")
                            .text("Percentage of Shots from");

                    eff_legend_svg.append("text")
                            .attr("transform","rotate(-90)")
                            .attr("y", eff_legend_width + 54)
                            .attr("x", 0 - (eff_height/2))
                            .attr("dy", "1em")
                            .attr("font-size",18)
                            .style("text-anchor", "middle")
                            .text("Three or Restricted Area");


                }

                var percPlot = function(plot_svg, court_area){
                    // make the color scale for the plot
                    var color = d3.scaleSequential().domain([d3.min(data, function(d){return          parseFloat(d[court_area]);}), d3.max(data, function(d){return parseFloat(d[court_area]);})])
                                    .interpolator(d3.interpolateInferno);

                    var circles = plot_svg.selectAll("circle")
                                            .data(data)
                                            .enter()
                                            .append("circle");

                    circles.attr("cx", function(d){
                                return three_xScale(parseFloat(d.pca_1));
                            })
                            .attr("cy", function(d){
                                return three_yScale(parseFloat(d.pca_2));
                            })
                            .attr("r", 8)
                            .attr("fill",function(d){return color(d[court_area]);})
                            .attr("stroke","black")
                            .attr("stroke-width",2)
                            .attr("opacity",.95);

                }

                var addLegend = function(svg, court_area, height, width, label){
                    var colorScale = d3.scaleSequential(d3.interpolateInferno)
                                        .domain([0, height])

                    var bars = svg.selectAll("rect")
                        .data(d3.range(height), function(d) { return d; })
                        .enter()
                        .append("rect")
                        .attr("x", 0)
                        .attr("y", function(d, i) { return height - i; })
                        .attr("height", 1)
                        .attr("width", width)
                        .style("fill", function(d, i ) { return colorScale(d); })

                    // yscale
                    var yScale = d3.scaleLinear()
                                    .domain([d3.min(data, function(d){return parseFloat(d[court_area]);}), d3.max(data, function(d){return parseFloat(d[court_area]);})])
                                    .range([height, 0]);

                    var yAxis = d3.axisRight(yScale);

                    svg.append("g")
                    .attr("transform", "translate(" + width + ",0)")
                    .call(yAxis);

                    svg.append("text")
                        .attr("transform","rotate(-90)")
                        .attr("y", width + 34)
                        .attr("x", 0 - (height/2))
                        .attr("dy", "1em")
                        .attr("font-size",18)
                        .style("text-anchor", "middle")
                        .text(label);


                }

                percPlot(three_svg, "3_PERC_OF_TOT")
                addLegend(three_legend_svg, "3_PERC_OF_TOT", three_legend_height, three_legend_width, "Percentage of Shots from 3")


                percPlot(close_svg, "Restricted_Area-Center(C)_PERC_TOT")
                addLegend(close_legend_svg, "Restricted_Area-Center(C)_PERC_TOT", close_legend_height, close_legend_width, "Percentage of Shots from Restricted Area")

                effPlot()
                effLegend()




            });

            /* This plot looks at specific changes
            in Houston's PCA over time */
            d3.csv("Data/Houston.csv").then(function(data){
                var seasons = d3.map(data, function(d){return d.Season;}).keys();
                var width = 800;
                var height = 600;
                var padding = 75;
                var buffer = .02;

                // When Harden Was traded to the Rockets
                var harden0 = data.find(item => item.Season === "2011-12")
                var harden1 = data.find(item => item.Season === "2012-13")

                var harden_pca1_diff = parseFloat(harden0.pca_1) - parseFloat(harden1.pca_1);
                var harden_pca2_diff = parseFloat(harden0.pca_2) - parseFloat(harden1.pca_2);

                var hardenHyp = hyp(harden_pca1_diff,harden_pca2_diff);

                // When they hired Dantoni
                var dantoni0 = data.find(item => item.Season === "2015-16")
                var dantoni1 = data.find(item => item.Season === "2016-17")

                var dantoni_pca1_diff = parseFloat(dantoni0.pca_1) - parseFloat(dantoni1.pca_1);
                var dantoni_pca2_diff = parseFloat(dantoni0.pca_2) - parseFloat(dantoni1.pca_2);

                var dantoniHyp = hyp(dantoni_pca1_diff,dantoni_pca2_diff);

                // Make the svg
                var svg = d3.select("#rockets-plot")
                            .append("svg")
                            .attr("width", width)
                            .attr("height",height)
                            .on("mouseover",mouseover)
                            .on("mouseout",mouseout);


                // Make x scale
                var xScale = d3.scaleLinear()
                                .domain([d3.min(data, function(d){return parseFloat(d.pca_1);}) - buffer, d3.max(data, function(d){return parseFloat(d.pca_1);}) + buffer])
                                    .range([padding, width - padding]);

                // Make y scale
                var yScale = d3.scaleLinear()
                                .domain([d3.min(data, function(d){return parseFloat(d.pca_2);}) - buffer, d3.max(data, function(d){return parseFloat(d.pca_2);}) + buffer])
                                    .range([height - padding, padding]);

                // Make x axis
                var xAxis = d3.axisBottom(xScale);

                // Make y axis
                var yAxis = d3.axisLeft(yScale);




                // Add in the line between 2011-12 and 2012-13
                var hardenLine = svg.append("line")
                                        .attr("x1",function() { return xScale(parseFloat(harden0.pca_1)); })
                                        .attr("y1",function() { return yScale(parseFloat(harden0.pca_2)); })
                                        .attr("x2",function() { return xScale(parseFloat(harden1.pca_1)); })
                                        .attr("y2",function() { return yScale(parseFloat(harden1.pca_2)); })
                                        .style("stroke","black")
                                        .style("stroke-width",3)
                                        .attr("opacity",0);

                // for the transition
                var hardenText = svg.append("text")
                                        .attr("font-size",20)
                                        .attr("fill","white")
                                        .attr("x", -50)
                                        .attr("y",-50)
                                        .text("James Harden is traded to the Rockets");

                // add in the line for dantoni's hiring
                var dantoniLine = svg.append("line")
                                        .attr("x1",function() { return xScale(parseFloat(dantoni0.pca_1)); })
                                        .attr("y1",function() { return yScale(parseFloat(dantoni0.pca_2)); })
                                        .attr("x2",function() { return xScale(parseFloat(dantoni1.pca_1)); })
                                        .attr("y2",function() { return yScale(parseFloat(dantoni1.pca_2)); })
                                        .style("stroke","black")
                                        .style("stroke-width",3)
                                        .attr("opacity",0);

                // for the transition
                var dantoniText = svg.append("text")
                                        .attr("font-size",20)
                                        .attr("fill","white")
                                        .attr("x",-50)
                                        .attr("y",-60)
                                        .text("Mike D'Antoni is hired");


                // add the circles
                var circles = svg.selectAll("circle")
                    .data(data)
                    .enter()
                    .append("circle")
                    .attr("cx",function(d){return xScale(parseFloat(d.pca_1));})
                    .attr("cy",function(d){return yScale(parseFloat(d.pca_2));})
                    .attr("Season",function(d){return d.Season;})
                    .attr("r",7)
                    .attr("id",function(d){return d.Season;})
                    .attr("fill","#CE1141")
                    .attr("stroke","#000000")
                    .attr("stroke-width",3)
                    .attr("opacity",1)
                    .append("svg:title")
                    .text(function(d) { return d.Season; });


                // start the transition when we mouseover the plot
                function mouseover() {
                    svg.selectAll("circle")
                            .data(data)
                            .filter(function(d){return (d.Season != "2011-12") &&
                                                        (d.Season != "2012-13");})
                            .transition("circles")
                            .duration(500)
                            .attr("opacity",.05)


                    hardenLine.transition("hardenLine")
                                .delay(200)
                                .attr("opacity",1);

                    hardenLine.transition("hardenLine")
                                .delay(600)
                                .duration(1000)
                                .attr("x2", function(){return xScale(parseFloat(harden0.pca_1) + hardenHyp);})
                                .attr("y2", function(){return yScale(parseFloat(harden0.pca_2));})
                                .transition("hardenLine")
                                .delay(800)
                                .duration(1000)
                                .attr("y1", function(){return yScale(parseFloat(harden0.pca_2))+50;})
                                .attr("y2", function(){return yScale(parseFloat(harden0.pca_2))+50;})
                                .transition("hardenLine")
                                .delay(3400)
                                .duration(1000)
                                .attr("x1",function() { return xScale(parseFloat(harden0.pca_1)); })
                                .attr("y1",function() { return yScale(parseFloat(harden0.pca_2)); })
                                .attr("x2",function() { return xScale(parseFloat(harden1.pca_1)); })
                                .attr("y2",function() { return yScale(parseFloat(harden1.pca_2)); })
                                .transition("hardenLine")
                                .delay(500)
                                .duration(500)
                                .attr("opacity",.3);

                    hardenText.transition("hardenText")
                                .delay(3000)
                                .attr("x", function(){return xScale(parseFloat(harden0.pca_1));})
                                .attr("y", function(){return yScale(parseFloat(harden0.pca_2))+40;})
                                .transition("hardenText")
                                .attr("fill","black")
                                .transition("hardenText")
                                .delay(3500)
                                .attr("fill","white");

                    svg.selectAll("circle")
                            .data(data)
                            .filter(function(d){return (d.Season === "2011-12") ||
                                                        (d.Season === "2012-13");})
                            .transition("circles")
                            .delay(8100)
                            .duration(500)
                            .attr("opacity",.3);

                    svg.selectAll("circle")
                            .data(data)
                            .filter(function(d){return (d.Season === "2015-16") ||
                                                (d.Season === "2016-17");})
                            .transition("circles")
                            .delay(8600)
                            .duration(500)
                            .attr("opacity",1);

                    dantoniLine.transition("dantoniLine")
                                .delay(8600)
                                .attr("opacity",1);

                    dantoniLine.transition("dantoniLine")
                                .delay(9100)
                                .duration(1000)
                                .attr("x2", function(){return xScale(parseFloat(dantoni0.pca_1) + dantoniHyp);})
                                .attr("y2", function(){return yScale(parseFloat(dantoni0.pca_2));})
                                .transition("dantoniLine")
                                .delay(800)
                                .duration(1000)
                                .attr("y1", function(){return yScale(dantoni0.pca_2) + 200;})
                                .attr("y2", function(){return yScale(dantoni0.pca_2) + 200;})
                                .transition("dantoniLine")
                                .delay(3400)
                                .duration(1000)
                                .attr("x1",function() { return xScale(parseFloat(dantoni0.pca_1)); })
                                .attr("y1",function() { return yScale(parseFloat(dantoni0.pca_2)); })
                                .attr("x2",function() { return xScale(parseFloat(dantoni1.pca_1)); })
                                .attr("y2",function() { return yScale(parseFloat(dantoni1.pca_2)); })
                                .transition("dantoniLine")
                                .delay(3200)
                                .duration(500)
                                .attr("opacity",0);

                    dantoniText.transition("dantoniText")
                                .delay(12000)
                                .attr("x", function(){return xScale(parseFloat(dantoni0.pca_1));})
                                .attr("y", function(){return yScale(parseFloat(dantoni0.pca_2))+ 190;})
                                .transition("dantoniText")
                                .attr("fill","black")
                                .transition("dantoniText")
                                .delay(3300)
                                .attr("fill","white");

                    svg.selectAll("circle")
                            .transition("circles")
                            .delay(17000)
                            .duration(500)
                            .attr("opacity",1);

                    hardenLine.transition("hardenLine")
                            .delay(17000)
                            .duration(500)
                            .attr("opacity",1)
                            .transition("hardenLine")
                            .duration(500)
                            .delay(2000)
                            .attr("opacity",0);


                }

                // halt the transition and return to defaults on mouseout
                function mouseout() {
                    svg.selectAll("circle")
                        .interrupt("circles");

                    hardenText.interrupt("hardenText");

                    hardenLine.interrupt("hardenLine");

                    dantoniText.interrupt("dantoniText");

                    dantoniLine.interrupt("dantoniLine");


                    svg.selectAll("circle")
                            .transition("1")
                            .duration(500)
                            .attr("opacity",1);

                    hardenLine.transition("2")
                                .attr("opacity",0);

                    hardenLine.transition("3")
                                .delay(500)
                                .attr("x1", function(){return xScale(parseFloat(harden0.pca_1));})
                                .attr("y1", function(){return yScale(parseFloat(harden0.pca_2));})
                                .attr("x2", function(){return xScale(parseFloat(harden1.pca_1));})
                                .attr("y2", function(){return yScale(parseFloat(harden1.pca_2));});





                    dantoniLine.transition("4")
                                .attr("opacity",0);

                    dantoniLine.transition("5")
                                .delay(500)
                                .attr("x1", function(){return xScale(parseFloat(dantoni0.pca_1));})
                                .attr("y1", function(){return yScale(parseFloat(dantoni0.pca_2));})
                                .attr("x2", function(){return xScale(parseFloat(dantoni1.pca_1));})
                                .attr("y2", function(){return yScale(parseFloat(dantoni1.pca_2));});

                    hardenText.transition("6")
                                .attr("fill","white")
                                .transition("8")
                                .delay(100)
                                .attr("x",-50)
                                .attr("y",-50);

                    dantoniText.transition("7")
                                .attr("fill","white")
                                .transition("9")
                                .delay(100)
                                .attr("x",-50)
                                .attr("y",-60);
                }




                // put on the x axis
                svg.append("g")
                    .attr("transform", "translate(0, " + (height - padding) +")")
                    .call(xAxis);

                // put on the y axis
                svg.append("g")
                    .attr("transform", "translate(" + padding + ",0)")
                    .call(yAxis);








            });

            /* Bucks plot, looks at specific events over time */
            d3.csv("Data/Bucks.csv").then(function(data){
                var width = 800;
                var height = 600;
                var padding = 75;
                var buffer = .02;

                var allStar0 = data.find(item => item.Season === "2015-16");
                var allStar1 = data.find(item => item.Season === "2016-17");

                var allStar_pca1_diff = parseFloat(allStar0.pca_1) - parseFloat(allStar1.pca_1);
                var allStar_pca2_diff = parseFloat(allStar0.pca_2) - parseFloat(allStar1.pca_2);

                var allStarHyp = hyp(allStar_pca1_diff,allStar_pca2_diff);

                var Bud0 = data.find(item => item.Season === "2017-18");
                var Bud1 = data.find(item => item.Season === "2018-19");

                var Bud_pca1_diff = parseFloat(Bud0.pca_1) - parseFloat(Bud1.pca_1);
                var Bud_pca2_diff = parseFloat(Bud0.pca_2) - parseFloat(Bud1.pca_2);

                var BudHyp = hyp(Bud_pca1_diff,Bud_pca2_diff);


                var svg = d3.select("#bucks-plot")
                            .append("svg")
                            .attr("width", width)
                            .attr("height",height)
                            .on("mouseover",mouseover)
                            .on("mouseout",mouseout);



                // Make x scale
                var xScale = d3.scaleLinear()
                                .domain([d3.min(data, function(d){return parseFloat(d.pca_1);}) - buffer, d3.max(data, function(d){return parseFloat(d.pca_1);}) + buffer])
                                    .range([padding, width - padding]);

                // Make y scale
                var yScale = d3.scaleLinear()
                                .domain([d3.min(data, function(d){return parseFloat(d.pca_2);}) - buffer, d3.max(data, function(d){return parseFloat(d.pca_2);}) + buffer])
                                    .range([height - padding, padding]);

                // Make x axis
                var xAxis = d3.axisBottom(xScale);

                // Make y axis
                var yAxis = d3.axisLeft(yScale);

                var allStarLine = svg.append("line")
                                        .attr("x1",function() { return xScale(parseFloat(allStar0.pca_1)); })
                                        .attr("y1",function() { return yScale(parseFloat(allStar0.pca_2)); })
                                        .attr("x2",function() { return xScale(parseFloat(allStar1.pca_1)); })
                                        .attr("y2",function() { return yScale(parseFloat(allStar1.pca_2)); })
                                        .style("stroke","black")
                                        .style("stroke-width",3)
                                        .attr("opacity",0);


                var BudLine = svg.append("line")
                                        .attr("x1",function() { return xScale(parseFloat(Bud0.pca_1)); })
                                        .attr("y1",function() { return yScale(parseFloat(Bud0.pca_2)); })
                                        .attr("x2",function() { return xScale(parseFloat(Bud1.pca_1)); })
                                        .attr("y2",function() { return yScale(parseFloat(Bud1.pca_2)); })
                                        .style("stroke","black")
                                        .style("stroke-width",3)
                                        .attr("opacity",0);


                svg.selectAll("circle")
                    .data(data)
                    .enter()
                    .append("circle")
                    .attr("cx",function(d){return xScale(parseFloat(d.pca_1));})
                    .attr("cy",function(d){return yScale(parseFloat(d.pca_2));})
                    .attr("r",6)
                    .attr("fill","#EEE1C6")
                    .attr("stroke","#00471B")
                    .attr("stroke-width",4)
                    .attr("opacity",1)
                    .append("svg:title")
                    .text(function(d) { return d.Season; });





                // put on the x axis
                svg.append("g")
                    .attr("transform", "translate(0, " + (height - padding) +")")
                    .call(xAxis);

                // put on the y axis
                svg.append("g")
                    .attr("transform", "translate(" + padding + ",0)")
                    .call(yAxis);



                var allStarText = svg.append("text")
                                        .attr("font-size",20)
                                        .attr("fill","white")
                                        .attr("x", -50)
                                        .attr("y",-50)
                                        .text("Giannis's first All Star season");


                var BudText = svg.append("text")
                                        .attr("font-size",20)
                                        .attr("fill","white")
                                        .attr("x", -50)
                                        .attr("y",-50)
                                        .text("Jason Kidd is replaced with Mike Budenholzer");

                function mouseover(){
                  svg.selectAll("circle")
                        .data(data)
                        .filter(function(d){return (d.Season != "2015-16") &&
                                                    (d.Season != "2016-17");})
                        .transition("circles")
                        .duration(500)
                        .attr("opacity",.05);

                  svg.selectAll("circle")
                        .data(data)
                        .filter(function(d){return (d.Season === "2015-16") ||
                                                    (d.Season === "2016-17");})
                        .transition("circles")
                        .delay(8500)
                        .duration(500)
                        .attr("opacity",.05);

                  svg.selectAll("circle")
                        .data(data)
                        .filter(function(d){return (d.Season === "2017-18") ||
                                                    (d.Season === "2018-19");})
                        .transition("circles")
                        .delay(8500)
                        .duration(500)
                        .attr("opacity",1);




                  allStarLine.transition("allStarLine")
                              .delay(200)
                              .attr("opacity",1);

                  allStarLine.transition("allStarLine")
                              .delay(600)
                              .duration(1000)
                              .attr("x2", function(){return xScale(parseFloat(allStar0.pca_1) + allStarHyp);})
                              .attr("y2", function(){return yScale(parseFloat(allStar0.pca_2));})
                              .transition("allStarLine")
                              .delay(800)
                              .duration(1000)
                              .attr("y1", function(){return yScale(parseFloat(allStar0.pca_2))+200;})
                              .attr("y2", function(){return yScale(parseFloat(allStar0.pca_2))+200;})
                              .transition("allStarLine")
                              .delay(3400)
                              .duration(1000)
                              .attr("x1",function() { return xScale(parseFloat(allStar0.pca_1)); })
                              .attr("y1",function() { return yScale(parseFloat(allStar0.pca_2)); })
                              .attr("x2",function() { return xScale(parseFloat(allStar1.pca_1)); })
                              .attr("y2",function() { return yScale(parseFloat(allStar1.pca_2)); })
                              .transition("allStarLine")
                              .delay(650)
                              .duration(500)
                              .attr("opacity",.05)
                              .transition("allStarLine")
                              .delay(7000)
                              .duration(500)
                              .attr("opacity",1)
                              .transition("allStarLine")
                              .delay(2700)
                              .duration(500)
                              .attr("opacity",0);

                  allStarText.transition("allStarText")
                              .delay(3000)
                              .attr("x", function(){return xScale(parseFloat(allStar0.pca_1));})
                              .attr("y", function(){return yScale(parseFloat(allStar0.pca_2))+190;})
                              .transition("allStarText")
                              .attr("fill","black")
                              .transition("allStarText")
                              .delay(3500)
                              .duration(0)
                              .attr("fill","white")
                              .attr("x",-50)
                              .attr("y",-50);


                  BudLine.transition("BudLine")
                              .delay(8500)
                              .duration(500)
                              .attr("opacity",1)
                              .transition("BudLine")
                              .delay(800)
                              .duration(1000)
                              .attr("y1", function(){return yScale(parseFloat(Bud0.pca_2))+80;})
                              .attr("y2", function(){return yScale(parseFloat(Bud0.pca_2))+80;})
                              .transition("BudLine")
                              .delay(3400)
                              .duration(1000)
                              .attr("x1",function() { return xScale(parseFloat(Bud0.pca_1)); })
                              .attr("y1",function() { return yScale(parseFloat(Bud0.pca_2)); })
                              .attr("x2",function() { return xScale(parseFloat(Bud1.pca_1)); })
                              .attr("y2",function() { return yScale(parseFloat(Bud1.pca_2)); })
                              .transition("BudLine")
                              .delay(4000)
                              .duration(500)
                              .attr("opacity",0);

                  BudText.transition("BudText")
                              .delay(10200)
                              .attr("x", function(){return xScale(parseFloat(Bud0.pca_1)) - 100;})
                              .attr("y", function(){return yScale(parseFloat(Bud0.pca_2))+70;})
                              .transition("BudText")
                              .attr("fill","black")
                              .transition("BudText")
                              .delay(3500)
                              .duration(0)
                              .attr("fill","white")
                              .attr("x",-50)
                              .attr("y",-50);

                  svg.selectAll("circle")
                        .transition("circles")
                        .delay(16000)
                        .duration(500)
                        .attr("opacity",1);


                }

                function mouseout(){
                  svg.selectAll("circle")
                      .interrupt("circles");

                  allStarText.interrupt("allStarText");

                  allStarLine.interrupt("allStarLine");

                  BudText.interrupt("BudText");

                  BudLine.interrupt("BudLine");


                  svg.selectAll("circle")
                          .transition("1")
                          .duration(0)
                          .attr("opacity",1);

                  allStarLine.transition("2")
                              .duration(0)
                              .attr("opacity",0);

                  allStarLine.transition("3")
                              .duration(0)
                              .attr("x1", function(){return xScale(parseFloat(allStar0.pca_1));})
                              .attr("y1", function(){return yScale(parseFloat(allStar0.pca_2));})
                              .attr("x2", function(){return xScale(parseFloat(allStar1.pca_1));})
                              .attr("y2", function(){return yScale(parseFloat(allStar1.pca_2));});





                  BudLine.transition("4")
                              .duration(0)
                              .attr("opacity",0);

                  BudLine.transition("5")
                              .delay(0)
                              .attr("x1", function(){return xScale(parseFloat(Bud0.pca_1));})
                              .attr("y1", function(){return yScale(parseFloat(Bud0.pca_2));})
                              .attr("x2", function(){return xScale(parseFloat(Bud1.pca_1));})
                              .attr("y2", function(){return yScale(parseFloat(Bud1.pca_2));});

                  allStarText.transition("6")
                              .duration(0)
                              .attr("fill","white")
                              .transition("8")
                              .duration(0)
                              .delay(100)
                              .attr("x",-50)
                              .attr("y",-50);

                  BudText.transition("7")
                              .attr("fill","white")
                              .transition("9")
                              .duration(0)
                              .delay(100)
                              .attr("x",-50)
                              .attr("y",-60);
                }


            });

            d3.csv("Data/Nets.csv").then(function(data){
                var width = 800;
                var height = 600;
                var padding = 75;
                var buffer = .02;

                var nets0 = data.find(item => item.Season === "2015-16");
                var nets1 = data.find(item => item.Season === "2016-17");

                var nets_pca1_diff = parseFloat(nets0.pca_1) - parseFloat(nets1.pca_1);
                var nets_pca2_diff = parseFloat(nets0.pca_2) - parseFloat(nets1.pca_2);

                var netsHyp = hyp(nets_pca1_diff,nets_pca2_diff);


                var svg = d3.select("#nets-plot")
                            .append("svg")
                            .attr("width", width)
                            .attr("height",height)
                            .on("mouseover",mouseover)
                            .on("mouseout",mouseout);



                // Make x scale
                var xScale = d3.scaleLinear()
                                .domain([d3.min(data, function(d){return parseFloat(d.pca_1);}) - buffer, d3.max(data, function(d){return parseFloat(d.pca_1);}) + buffer])
                                    .range([padding, width - padding]);

                // Make y scale
                var yScale = d3.scaleLinear()
                                .domain([d3.min(data, function(d){return parseFloat(d.pca_2);}) - buffer, d3.max(data, function(d){return parseFloat(d.pca_2);}) + buffer])
                                    .range([height - padding, padding]);

                // Make x axis
                var xAxis = d3.axisBottom(xScale);

                // Make y axis
                var yAxis = d3.axisLeft(yScale);

                var netsLine = svg.append("line")
                                        .attr("x1",function() { return xScale(parseFloat(nets0.pca_1)); })
                                        .attr("y1",function() { return yScale(parseFloat(nets0.pca_2)); })
                                        .attr("x2",function() { return xScale(parseFloat(nets1.pca_1)); })
                                        .attr("y2",function() { return yScale(parseFloat(nets1.pca_2)); })
                                        .style("stroke","black")
                                        .style("stroke-width",3)
                                        .attr("opacity",0);

                var netsText = svg.append("text")
                                        .attr("font-size",20)
                                        .attr("fill","white")
                                        .attr("x", -50)
                                        .attr("y",-50)
                                        .text("Sean Marks Hires Coach Kenny Atkinson");





                svg.selectAll("circle")
                    .data(data)
                    .enter()
                    .append("circle")
                    .attr("cx",function(d){return xScale(parseFloat(d.pca_1));})
                    .attr("cy",function(d){return yScale(parseFloat(d.pca_2));})
                    .attr("r",6)
                    .attr("fill","#FFFFFF")
                    .attr("stroke","#000000")
                    .attr("stroke-width",4)
                    .attr("opacity",1)
                    .append("svg:title")
                    .text(function(d) { return d.Season; });



                // put on the x axis
                svg.append("g")
                    .attr("transform", "translate(0, " + (height - padding) +")")
                    .call(xAxis);

                // put on the y axis
                svg.append("g")
                    .attr("transform", "translate(" + padding + ",0)")
                    .call(yAxis);


                function mouseover() {
                    svg.selectAll("circle")
                            .data(data)
                            .filter(function(d){return (d.Season != "2015-16") &&
                                                        (d.Season != "2016-17");})
                            .transition("circles")
                            .duration(500)
                            .attr("opacity",.05)
                            .transition("circles")
                            .delay(9000)
                            .duration(500)
                            .attr("opacity",1);


                    netsLine.transition("netsLine")
                                .delay(200)
                                .attr("opacity",1);

                    netsLine.transition("netsLine")
                                .delay(600)
                                .duration(1000)
                                .attr("x2", function(){return xScale(parseFloat(nets0.pca_1) + netsHyp);})
                                .attr("y2", function(){return yScale(parseFloat(nets0.pca_2));})
                                .transition("netsLine")
                                .delay(800)
                                .duration(1000)
                                .attr("y1", function(){return yScale(parseFloat(nets0.pca_2))+50;})
                                .attr("y2", function(){return yScale(parseFloat(nets0.pca_2))+50;})
                                .transition("netsLine")
                                .delay(3400)
                                .duration(1000)
                                .attr("x1",function() { return xScale(parseFloat(nets0.pca_1)); })
                                .attr("y1",function() { return yScale(parseFloat(nets0.pca_2)); })
                                .attr("x2",function() { return xScale(parseFloat(nets1.pca_1)); })
                                .attr("y2",function() { return yScale(parseFloat(nets1.pca_2)); })
                                .transition("netsLine")
                                .delay(4000)
                                .duration(500)
                                .attr("opacity",0);

                    netsText.transition("netsText")
                                .delay(3000)
                                .attr("x", function(){return xScale(parseFloat(nets0.pca_1));})
                                .attr("y", function(){return yScale(parseFloat(nets0.pca_2))+40;})
                                .transition("6")
                                .attr("fill","black")
                                .transition("8")
                                .delay(3500)
                                .attr("fill","white");




                }

                function mouseout() {
                    svg.selectAll("circle")
                        .interrupt("circles");

                    netsText.interrupt("netsText");

                    netsLine.interrupt("netsLine");


                    svg.selectAll("circle")
                            .transition("1")
                            .duration(500)
                            .attr("opacity",1);

                    netsLine.transition("2")
                                .attr("opacity",0);

                    netsLine.transition("3")
                                .delay(500)
                                .attr("x1", function(){return xScale(parseFloat(nets0.pca_1));})
                                .attr("y1", function(){return yScale(parseFloat(nets0.pca_2));})
                                .attr("x2", function(){return xScale(parseFloat(nets1.pca_1));})
                                .attr("y2", function(){return yScale(parseFloat(nets1.pca_2));});

                    netsText.transition("6")
                                .attr("fill","white")
                                .transition("8")
                                .delay(100)
                                .attr("x",-50)
                                .attr("y",-50);
                }


            });

            d3.csv("Data/sixers.csv").then(function(data){
              var width = 800;
              var height = 600;
              var padding = 75;
              var buffer = .02;

              var sixers0 = data.find(item => item.Season === "2012-13");
              var sixers1 = data.find(item => item.Season === "2013-14");

              var sixers_pca1_diff = parseFloat(sixers0.pca_1) - parseFloat(sixers1.pca_1);
              var sixers_pca2_diff = parseFloat(sixers0.pca_2) - parseFloat(sixers1.pca_2);

              var sixersHyp = hyp(sixers_pca1_diff,sixers_pca2_diff);


              var svg = d3.select("#sixers-plot")
                          .append("svg")
                          .attr("width", width)
                          .attr("height",height)
                          .on("mouseover",mouseover)
                          .on("mouseout",mouseout);




              // Make x scale
              var xScale = d3.scaleLinear()
                              .domain([d3.min(data, function(d){return parseFloat(d.pca_1);}) - buffer, d3.max(data, function(d){return parseFloat(d.pca_1);}) + buffer])
                                  .range([padding, width - padding]);

              // Make y scale
              var yScale = d3.scaleLinear()
                              .domain([d3.min(data, function(d){return parseFloat(d.pca_2);}) - buffer, d3.max(data, function(d){return parseFloat(d.pca_2);}) + buffer])
                                  .range([height - padding, padding]);

              // Make x axis
              var xAxis = d3.axisBottom(xScale);

              // Make y axis
              var yAxis = d3.axisLeft(yScale);

              var sixersLine = svg.append("line")
                                      .attr("x1",function() { return xScale(parseFloat(sixers0.pca_1)); })
                                      .attr("y1",function() { return yScale(parseFloat(sixers0.pca_2)); })
                                      .attr("x2",function() { return xScale(parseFloat(sixers1.pca_1)); })
                                      .attr("y2",function() { return yScale(parseFloat(sixers1.pca_2)); })
                                      .style("stroke","black")
                                      .style("stroke-width",3)
                                      .attr("opacity",0);

              var sixersText = svg.append("text")
                                      .attr("font-size",20)
                                      .attr("fill","white")
                                      .attr("x", -50)
                                      .attr("y",-50)
                                      .text("Sam Presti becomes GM");





              svg.selectAll("circle")
                  .data(data)
                  .enter()
                  .append("circle")
                  .attr("cx",function(d){return xScale(parseFloat(d.pca_1));})
                  .attr("cy",function(d){return yScale(parseFloat(d.pca_2));})
                  .attr("r",6)
                  .attr("fill","#ED174C")
                  .attr("stroke","#006BB6")
                  .attr("stroke-width",4)
                  .attr("opacity",1)
                  .append("svg:title")
                  .text(function(d) { return d.Season; });



              // put on the x axis
              svg.append("g")
                  .attr("transform", "translate(0, " + (height - padding) +")")
                  .call(xAxis);

              // put on the y axis
              svg.append("g")
                  .attr("transform", "translate(" + padding + ",0)")
                  .call(yAxis);


                  function mouseover() {
                      svg.selectAll("circle")
                              .data(data)
                              .filter(function(d){return (d.Season != "2012-13") &&
                                                          (d.Season != "2013-14");})
                              .transition("circles")
                              .duration(500)
                              .attr("opacity",.05)
                              .transition("circles")
                              .delay(9000)
                              .duration(500)
                              .attr("opacity",1);


                      sixersLine.transition("sixersLine")
                                  .delay(200)
                                  .attr("opacity",1);

                      sixersLine.transition("sixersLine")
                                  .delay(600)
                                  .duration(1000)
                                  .attr("x2", function(){return xScale(parseFloat(sixers0.pca_1) + sixersHyp);})
                                  .attr("y2", function(){return yScale(parseFloat(sixers0.pca_2));})
                                  .transition("sixersLine")
                                  .delay(800)
                                  .duration(1000)
                                  .attr("y1", function(){return yScale(parseFloat(sixers0.pca_2))+50;})
                                  .attr("y2", function(){return yScale(parseFloat(sixers0.pca_2))+50;})
                                  .transition("sixersLine")
                                  .delay(3400)
                                  .duration(1000)
                                  .attr("x1",function() { return xScale(parseFloat(sixers0.pca_1)); })
                                  .attr("y1",function() { return yScale(parseFloat(sixers0.pca_2)); })
                                  .attr("x2",function() { return xScale(parseFloat(sixers1.pca_1)); })
                                  .attr("y2",function() { return yScale(parseFloat(sixers1.pca_2)); })
                                  .transition("sixersLine")
                                  .delay(4000)
                                  .duration(500)
                                  .attr("opacity",0);

                      sixersText.transition("sixersText")
                                  .delay(3000)
                                  .attr("x", function(){return xScale(parseFloat(sixers0.pca_1));})
                                  .attr("y", function(){return yScale(parseFloat(sixers0.pca_2))+40;})
                                  .transition("6")
                                  .attr("fill","black")
                                  .transition("8")
                                  .delay(3500)
                                  .attr("fill","white");




                  }

                  function mouseout() {
                      svg.selectAll("circle")
                          .interrupt("circles");

                      sixersText.interrupt("sixersText");

                      sixersLine.interrupt("sixersLine");


                      svg.selectAll("circle")
                              .transition("1")
                              .duration(500)
                              .attr("opacity",1);

                      sixersLine.transition("2")
                                  .attr("opacity",0);

                      sixersLine.transition("3")
                                  .delay(500)
                                  .attr("x1", function(){return xScale(parseFloat(sixers0.pca_1));})
                                  .attr("y1", function(){return yScale(parseFloat(sixers0.pca_2));})
                                  .attr("x2", function(){return xScale(parseFloat(sixers1.pca_1));})
                                  .attr("y2", function(){return yScale(parseFloat(sixers1.pca_2));});

                      sixersText.transition("6")
                                  .attr("fill","white")
                                  .transition("8")
                                  .delay(100)
                                  .attr("x",-50)
                                  .attr("y",-50);
                  }
            })

            d3.csv("Data/14_15_use.csv").then(function(data){
                var width = 800;
                var height = 600;
                var padding = 75;
                var buffer = .02;


                var svg = d3.select("#warriors-plot")
                            .append("svg")
                            .attr("width", width)
                            .attr("height",height);


                // Make x scale
                var xScale = d3.scaleLinear()
                                .domain([d3.min(data, function(d){return parseFloat(d.pca_1);}) - buffer, d3.max(data, function(d){return parseFloat(d.pca_1);}) + buffer])
                                    .range([padding, width - padding]);

                // Make y scale
                var yScale = d3.scaleLinear()
                                .domain([d3.min(data, function(d){return parseFloat(d.pca_2);}) - buffer, d3.max(data, function(d){return parseFloat(d.pca_2);}) + buffer])
                                    .range([height - padding, padding]);

                // Make x axis
                var xAxis = d3.axisBottom(xScale);

                // Make y axis
                var yAxis = d3.axisLeft(yScale);

                // put on the x axis
                svg.append("g")
                    .attr("transform", "translate(0, " + (height - padding) +")")
                    .call(xAxis);

                // put on the y axis
                svg.append("g")
                    .attr("transform", "translate(" + padding + ",0)")
                    .call(yAxis);

                setPlot();

                var button = d3.select("#warriors-button");

                button.on("click",function(){
                    button.removeEventListener("click");

                    warriorsSequence();

                    setTimeout(function() {
                          button.setClickable(true);
                    }, 31000);

                });

                d3.select("#warriors-button")
                  .on("click",function(){
                            d3.selectAll("circles")
                              .interrupt();

                            warriorsSequence();
                      });








                function setPlot(){
                            svg.selectAll("circle")
                                .data(data)
                                .enter()
                                .append("circle")
                                .attr("cx",function(d){return xScale(parseFloat(d.pca_1));})
                                .attr("cy",function(d){return yScale(parseFloat(d.pca_2));})
                                .attr("r",6)
                                .attr("stroke-width",4)
                                .attr("stroke","black")
                                .attr("fill","black")
                                .attr("opacity",0)
                                .filter(function(d){return d.TEAM_NAME === "Golden State Warriors";})
                                .attr("fill","#FFC72C")
                                .attr("stroke","#1D428A")
                                .attr("id","GSW");

                            svg.append("text")
                                .attr("font-size","20")
                                .attr("fill","black")
                                .attr("x",100)
                                .attr("y",100)
                                .attr("id","note")
                                .text("");

                }



                function warriorsSequence(){

                    svg.selectAll("circle")
                        .interrupt("gsw");

                    svg.selectAll("circle")
                        .interrupt("ngsw");

                    svg.selectAll("#note")
                        .interrupt("note");

                    svg.selectAll("circle")
                        .transition("start")
                        .delay(0)
                        .duration(0)
                        .attr("opacity",0);

                    var ids = ["#fourteen","#fifteen","#sixteen","#seventeen","#eighteen"];

                    ids.forEach(function (item, index) {
                      d3.select(item)
                          .interrupt("num_teams");

                      d3.select(item)
                          .transition("num_teams")
                          .text("");
                    });



                    var note = svg.selectAll("#note");



                    svg.selectAll("circle")
                        .data(data)
                        .filter(function(d){return d.Season === "2014-15" &
                                            d.TEAM_NAME === "Golden State Warriors";})
                        .transition("gsw")
                        .duration(500)
                        .attr("opacity",1)
                        .transition("gsw")
                        .delay(5000)
                        .duration(500)
                        .attr("opacity",.3);

                    svg.selectAll("circle")
                        .data(data)
                        .filter(function(d){return d.Season === "2014-15" &&
                                                d.TEAM_NAME != "Golden State Warriors";})
                        .transition("ngsw")
                        .delay(2000)
                        .duration(500)
                        .attr("opacity",1)
                        .transition("ngsw")
                        .delay(3000)
                        .duration(500)
                        .attr("opacity",0);



                    note.transition("note")
                            .duration(500)
                            .text("The Golden State Warriors Win the Title in 2014-15.")
                            .transition("note")
                            .delay(1600)
                            .duration(0)
                            .text("The rest of the NBA in 2014-15.")
                            .transition("note")
                            .delay(3500)
                            .duration(0)
                            .text("The Warriors lose to the Cavs in 2015-16.")
                            .transition("note")
                            .delay(2000)
                            .text("The rest of the NBA in 2015-16")
                            .transition("note")
                            .delay(2500)
                            .text("Durant goes to the Warriors, they win in 2016-17")
                            .transition("note")
                            .delay(2000)
                            .text("The rest of the NBA in 2016-17")
                            .transition("note")
                            .delay(2500)
                            .text("Warriors repeat in 2017-18")
                            .transition("note")
                            .delay(2000)
                            .text("The rest of the NBA in 2017-18")
                            .transition("note")
                            .delay(3000)
                            .text("The Warriors lose to Toronto in 2018-19")
                            .transition("note")
                            .delay(2000)
                            .text("The rest of the NBA in 2018-19")
                            .transition("note")
                            .delay(3000)
                            .text("");

                   svg.selectAll("circle")
                        .data(data)
                        .filter(function(d){return d.Season === "2015-16" &&
                                                d.TEAM_NAME === "Golden State Warriors";})
                        .transition("gsw")
                        .delay(5500)
                        .duration(500)
                        .attr("opacity",1)
                        .transition("gsw")
                        .delay(4000)
                        .duration(500)
                        .attr("opacity",.3);

                    svg.selectAll("circle")
                        .data(data)
                        .filter(function(d){return d.Season === "2015-16" &&
                                                d.TEAM_NAME != "Golden State Warriors";})
                        .transition("ngsw")
                        .delay(7500)
                        .duration(500)
                        .attr("opacity",1)
                        .transition("ngsw")
                        .delay(2000)
                        .duration(500)
                        .attr("opacity",0);

                    svg.selectAll("circle")
                        .data(data)
                        .filter(function(d){return d.Season === "2016-17" &&
                                                d.TEAM_NAME === "Golden State Warriors";})
                        .transition("gsw")
                        .delay(10000)
                        .duration(800)
                        .attr("opacity",1)
                        .transition("gsw")
                        .delay(3600)
                        .duration(800)
                        .attr("opacity",.3);

                    svg.selectAll("circle")
                        .data(data)
                        .filter(function(d){return d.Season === "2016-17" &&
                                                    d.TEAM_NAME != "Golden State Warriors";})
                        .transition("ngsw")
                        .delay(12000)
                        .duration(800)
                        .attr("opacity",1)
                        .transition("ngsw")
                        .delay(1500)
                        .duration(800)
                        .attr("opacity",0);

                    svg.selectAll("circle")
                        .data(data)
                        .filter(function(d){return d.Season === "2017-18" &&
                                                    d.TEAM_NAME === "Golden State Warriors";})
                        .transition("gsw")
                        .delay(14500)
                        .duration(800)
                        .attr("opacity",1)
                        .transition("gsw")
                        .delay(4000)
                        .duration(800)
                        .attr("opacity",.3);

                    svg.selectAll("circle")
                        .data(data)
                        .filter(function(d){return d.Season === "2017-18" &&
                                                    d.TEAM_NAME != "Golden State Warriors";})
                        .transition("ngsw")
                        .delay(16500)
                        .duration(800)
                        .attr("opacity",1)
                        .transition("ngsw")
                        .delay(2000)
                        .duration(800)
                        .attr("opacity",0);

                    svg.selectAll("circle")
                        .data(data)
                        .filter(function(d){return d.Season === "2018-19" &&
                                                    d.TEAM_NAME === "Golden State Warriors";})
                        .transition("gsw")
                        .delay(19500)
                        .duration(800)
                        .attr("opacity",1);

                    svg.selectAll("circle")
                        .data(data)
                        .filter(function(d){return d.Season === "2018-19" &&
                                                    d.TEAM_NAME != "Golden State Warriors";})
                        .transition("ngsw")
                        .delay(21500)
                        .duration(800)
                        .attr("opacity",1)
                        .transition("ngsw")
                        .delay(2000)
                        .duration(800)
                        .attr("opacity",0);

                    svg.selectAll("circle")
                        .data(data)
                        .filter(function(d){return d.TEAM_NAME === "Golden State Warriors";})
                        .transition("gsw")
                        .delay(25000)
                        .duration(1000)
                        .attr("opacity",1);

                    svg.selectAll("circle")
                        .data(data)
                        .filter(function(d){return d.TEAM_NAME != "Golden State Warriors";})
                        .transition("ngsw")
                        .delay(28000)
                        .duration(1000)
                        .attr("opacity",1);

                    d3.csv("Data/num_teams_warriors.csv").then(function(data){

                      d3.select("#fourteen")
                          .transition("num_teams")
                          .delay(2300)
                          .text(data[0].NumTeams);


                      d3.select("#fifteen")
                          .transition("num_teams")
                          .delay(7800)
                          .text(data[1].NumTeams);

                      d3.select("#sixteen")
                          .transition("num_teams")
                          .delay(12300)
                          .text(data[2].NumTeams);

                    d3.select("#seventeen")
                          .transition("num_teams")
                          .delay(16900)
                          .text(data[3].NumTeams);

                    d3.select("#eighteen")
                          .transition("num_teams")
                          .delay(21900)
                          .text(data[4].NumTeams);






                    })




                };


            });



            function linspace(start, end, n) {
                var out = [];
                var delta = (end - start) / (n - 1);

                var i = 0;
                while(i < (n - 1)) {
                    out.push(start + (i * delta));
                    i++;
                }

                out.push(end);
                return out;
            }

            function hyp(a,b) {
                return Math.sqrt(a*a + b*b)
            }

        </script>


    </body>
</html>
